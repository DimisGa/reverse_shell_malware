#from socket import socket, gethostname
import socket


def video_capture():
    s = socket.socket()
    host = '192.168.2.2'
    port = 6666
    s.bind((host, port))
    s.listen(1)
    n = 0

    while True:
        print("Listening for connections...")
        connection, addr = s.accept()

        try:
            print("Starting to read bytes..")
            buffer = connection.recv(1024)

            with open('video'+str(n)+'.avi', "wb") as video:
                n += 1
                i = 0
                while buffer:
                    #buffer = connection.recv(1024)
                    video.write(buffer)
                    print("buffer {0}".format(i))
                    i += 1
                    buffer = connection.recv(1024)

            print("Done reading bytes..")
            connection.close()

        except KeyboardInterrupt:
            if connection:
                connection.close()
            break

    s.close()
